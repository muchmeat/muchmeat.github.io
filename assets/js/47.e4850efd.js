(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{354:function(s,t,a){"use strict";a.r(t);var n=a(14),r=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"一些sql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一些sql"}},[s._v("#")]),s._v(" 一些SQL")]),s._v(" "),t("h2",{attrs:{id:"分割字符串拿出最后一个元素"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#分割字符串拿出最后一个元素"}},[s._v("#")]),s._v(" 分割字符串拿出最后一个元素")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" SUBSTR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("column_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" INSTR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("column_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" last_element\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" table_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h2",{attrs:{id:"_1970年至今毫秒数转为date"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1970年至今毫秒数转为date"}},[s._v("#")]),s._v(" 1970年至今毫秒数转为date")]),s._v(" "),t("p",[s._v("注意东八区时差问题")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" TO_DATE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1970-01-01'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'YYYY-MM-DD'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" milliseconds "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" converted_date\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" dual"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" TO_DATE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1970-01-01 08:00:00'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'YYYY-MM-DD HH24:MI:SS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" milliseconds "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("86400000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" converted_date\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" dual"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n")])])]),t("h2",{attrs:{id:"查询锁定记录并删除"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查询锁定记录并删除"}},[s._v("#")]),s._v(" 查询锁定记录并删除")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("serial")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" v$locked_object lo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n     dba_objects ao"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n     v$"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("session")]),s._v(" s\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" ao"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("object_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" lo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("object_id\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" lo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("session_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v("\nsystem "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KILL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("session")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'SID,serial#'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h2",{attrs:{id:"查询某个时间段的统计数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查询某个时间段的统计数据"}},[s._v("#")]),s._v(" 查询某个时间段的统计数据")]),s._v(" "),t("p",[s._v("比如查询近一周每天的统计数据")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" to_char"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("date_list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("date_of_week"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'YYYY-MM-DD'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("COUNT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("t2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" y\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" TRUNC"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SYSDATE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LEVEL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" date_of_week\n      "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" dual "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CONNECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LEVEL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" date_list\n         "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LEFT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rpynr_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" rpynr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rpy_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" rpy"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pyrq\n                    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" t_qbzh_rpyzgfk t\n                             "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("join")]),s._v(" t_qbzh_rpynr rpynr\n                                  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rpynr_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" rpynr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id\n                             "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("join")]),s._v(" t_qbzh_rpy rpy\n                                  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" rpy"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" rpynr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rpy_id\n                    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sfyx_st "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1'")]),s._v("\n                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" rpynr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sfyx_st "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1'")]),s._v("\n                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" rpy"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sfyx_st "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1'")]),s._v("\n                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" rpy"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pydwdm "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IN")]),s._v("\n                          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" D"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ORGAN_CODE\n                           "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" SYS_ORGAN D\n                           "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" D"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SFYX_ST "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1'")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("START")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" D"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ORGAN_CODE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'340822410000'")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CONNECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" NOCYCLE PRIOR D"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ID "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" D"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("PARENT_ORG"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" T2\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" TRUNC"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("t2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pyrq"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" date_list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("date_of_week\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GROUP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" date_list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("date_of_week\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" date_list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("date_of_week"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);