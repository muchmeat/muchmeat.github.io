(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{359:function(s,n,t){"use strict";t.r(n);var e=t(14),a=Object(e.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"powerdesigner-数据库字段小写转大写"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#powerdesigner-数据库字段小写转大写"}},[s._v("#")]),s._v(" powerDesigner 数据库字段小写转大写")]),s._v(" "),n("h2",{attrs:{id:"脚本"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#脚本"}},[s._v("#")]),s._v(" 脚本")]),s._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("Option Explicit\nValidationMode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" True\nInteractiveMode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" im_Batch\n\nDim mdl "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("' the current model\n\n'")]),s._v(" 取得当前Model\nSet mdl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ActiveModel\nIf "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mdl Is Nothing"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Then\nMsgBox "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"There is no current Model"')]),s._v("\nElseIf Not mdl.IsKindOf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PdPDM.cls_Model"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Then\nMsgBox "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The current model is not an Physical Data model."')]),s._v("\nElse\nProcessFolder mdl\nEnd If\n\nPrivate sub ProcessFolder"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("folder"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'处理表\nDim Tab\nfor each Tab in folder.tables\ntab.code = UCase(tab.code)\n'")]),s._v("修改字段名\nDim col\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" each col "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" tab.columns\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("col.code")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" UCase"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("col.code"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nnext\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'修改索引名\nDim idx\nfor each idx in tab.indexes\nidx.code= UCase(idx.code)\nnext\n'")]),s._v("修改主键名\nDim key\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" each key "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" tab.keys\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("key.code")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" UCase"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key.code"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nnext\nnext\n\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("' 同理处理视图\n'")]),s._v(" Dim view\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("' for each view in folder.Views\n'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" not view.isShortcut "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("' view.code = view.name\n'")]),s._v(" end "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("' next\n\n'")]),s._v(" go into the sub-packages\nDim f ' running folder\nFor Each f In folder.Packages\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" not f.IsShortcut "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\nProcessFolder f\nend "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\nNext\nend sub\n\n\n")])])])])}),[],!1,null,null,null);n.default=a.exports}}]);