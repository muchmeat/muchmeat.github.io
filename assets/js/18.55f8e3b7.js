(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{305:function(a,e,s){a.exports=s.p+"assets/img/img.44bf4686.png"},346:function(a,e,s){"use strict";s.r(e);var t=s(14),l=Object(t.a)({},(function(){var a=this,e=a._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"sql性能分析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sql性能分析"}},[a._v("#")]),a._v(" SQL性能分析")]),a._v(" "),e("p",[a._v("windows系统内，与Linux会有所不同")]),a._v(" "),e("h2",{attrs:{id:"执行频率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#执行频率"}},[a._v("#")]),a._v(" 执行频率")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("show global|session status\n")])])]),e("p",[a._v("如 show global status like 'Com_______'; 查询信息如下\n"),e("img",{attrs:{src:s(305),alt:"img.png"}})]),a._v(" "),e("h2",{attrs:{id:"慢查询日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#慢查询日志"}},[a._v("#")]),a._v(" 慢查询日志")]),a._v(" "),e("p",[a._v("记录所有执行时间超过指定参数(long_query_time,单位：秒，默认10秒)的所有SQL语句的日志")]),a._v(" "),e("ul",[e("li",[a._v("查看慢查询日志是否开启")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("show VARIABLES like 'slow_query_log';\n")])])]),e("ul",[e("li",[a._v("开启慢查询")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("set global slow_query_log='ON'\n")])])]),e("ul",[e("li",[a._v("查看执行时间阈值")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("show VARIABLES like 'long_query_time';\n")])])]),e("ul",[e("li",[a._v("日志文件地址")])]),a._v(" "),e("p",[a._v("C:\\ProgramData\\MySQL\\MySQL Server 8.0\\Data .log")]),a._v(" "),e("h2",{attrs:{id:"profile详情"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#profile详情"}},[a._v("#")]),a._v(" profile详情")]),a._v(" "),e("p",[a._v("帮助了解SQL时间耗费到哪里去了")]),a._v(" "),e("ul",[e("li",[a._v("查看是否支持profile操作")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("select @@have_profiling\n")])])]),e("ul",[e("li",[a._v("查看profile是否开启")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("-- 1开启 0未开启\nselect @@profiling;\n\n-- 开启profile\nset profiling = 1;\n")])])]),e("ul",[e("li",[a._v("查看每一条SQL的耗时情况")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("show PROFILES;\n")])])]),e("ul",[e("li",[a._v("查看指定 query_id 的SQL语句每个阶段的耗时情况")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("show profile for query query_id;\n")])])]),e("ul",[e("li",[a._v("查看指定 query_id 的SQL语句CPU的耗时情况")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("show profile cpu for query query_id;\n")])])]),e("h2",{attrs:{id:"explain执行计划"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#explain执行计划"}},[a._v("#")]),a._v(" explain执行计划")]),a._v(" "),e("p",[a._v("在SQL语句之前加上 explain")]),a._v(" "),e("p",[a._v("explain执行计划各字段含义")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("id select")]),a._v(" "),e("p",[a._v("查询的序列号，表示查询中执行select子句或者操作表的顺序（id相同，执行顺序从上到下；id不同，值越大，越先执行）")])]),a._v(" "),e("li",[e("p",[a._v("select_type")]),a._v(" "),e("p",[a._v("分辨查询的类型，是普通查询还是联合查询还是子查询,常见的取值有SIMPLE(简单表，不使用表连接或者子查询)、PRIMARY(主查询，即外层的查询)、UNION(UNION中的第二个或者后面的查询语句)、SUBQUERY(子查询)等")])]),a._v(" "),e("li",[e("p",[a._v("type")]),a._v(" "),e("p",[a._v("连接类型，性能由好到差 null > system > const > eq_ref > ref > fulltext > ref_or_null > index_merge > unique_subquery > index_subquery > range > index > ALL")])])])])}),[],!1,null,null,null);e.default=l.exports}}]);