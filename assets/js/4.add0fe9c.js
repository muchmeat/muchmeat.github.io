(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{277:function(s,a,t){s.exports=t.p+"assets/img/img_3.4e0e982f.png"},278:function(s,a,t){s.exports=t.p+"assets/img/img_8.3a09db85.png"},279:function(s,a,t){s.exports=t.p+"assets/img/img_9.6fde0da2.png"},280:function(s,a,t){s.exports=t.p+"assets/img/img_4.a94b53e1.png"},281:function(s,a,t){s.exports=t.p+"assets/img/img_5.f4f9f90f.png"},322:function(s,a,t){"use strict";t.r(a);var e=t(14),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"在wsl2环境下ubuntu内使用存储库安装docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在wsl2环境下ubuntu内使用存储库安装docker"}},[s._v("#")]),s._v(" 在WSL2环境下Ubuntu内使用存储库安装docker")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docs.docker.com/engine/install/ubuntu/#install-using-the-repository",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"卸载旧版本docker-docker-io-docker-engine"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#卸载旧版本docker-docker-io-docker-engine"}},[s._v("#")]),s._v(" 卸载旧版本docker docker.io docker-engine")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" remove "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" docker-engine docker.io containerd runc\n")])])]),a("p",[s._v("如果报告未安装这些包，则没有问题。 apt-get将保留的内容包括映像、容器、数据卷和网络。 如果不需要保存现有数据，并希望从全新安装开始，可以进行手动删除。 删除所有映像、容器和数据卷：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /var/lib/docker \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /var/lib/containerd\n")])])]),a("h2",{attrs:{id:"设置存储库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置存储库"}},[s._v("#")]),s._v(" 设置存储库")]),s._v(" "),a("h3",{attrs:{id:"_1-更新软件包索引并安装软件包-以允许通过-https-使用存储库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-更新软件包索引并安装软件包-以允许通过-https-使用存储库"}},[s._v("#")]),s._v(" 1.更新软件包索引并安装软件包，以允许通过 HTTPS 使用存储库")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ca-certificates "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" gnupg\n")])])]),a("h3",{attrs:{id:"_2-添加-docker-的官方-gpg-密钥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-添加-docker-的官方-gpg-密钥"}},[s._v("#")]),s._v(" 2.添加 Docker 的官方 GPG 密钥")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" 0755 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" /etc/apt/keyrings\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-fsSL")]),s._v(" https://download.docker.com/linux/ubuntu/gpg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" gpg "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--dearmor")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" /etc/apt/keyrings/docker.gpg\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" a+r /etc/apt/keyrings/docker.gpg\n")])])]),a("h3",{attrs:{id:"_3-使用以下命令设置存储库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-使用以下命令设置存储库"}},[s._v("#")]),s._v(" 3.使用以下命令设置存储库")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"deb [arch="')]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("dpkg --print-architecture"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \\\n  "')]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" /etc/os-release "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$VERSION_CODENAME")]),s._v('"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" stable"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/apt/sources.list.d/docker.list "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /dev/null\n")])])]),a("h2",{attrs:{id:"安装docker引擎"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装docker引擎"}},[s._v("#")]),s._v(" 安装docker引擎")]),s._v(" "),a("p",[s._v("更新包索引，并安装最新版本的 docker-ce，docker-ce-cli，containerd.io，docker-compose-plugin。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n")])])]),a("p",[s._v("也可以指定版本")]),s._v(" "),a("h2",{attrs:{id:"查看docker引擎版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看docker引擎版本"}},[s._v("#")]),s._v(" 查看docker引擎版本")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version\n")])])]),a("p",[s._v("这时出现了以下问题\n"),a("img",{attrs:{src:t(277),alt:"img_3.png"}})]),s._v(" "),a("p",[s._v("看起来是docker守护进程没有启动，执行以下命令")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])])]),a("p",[s._v("出现以下问题\n"),a("img",{attrs:{src:t(278),alt:"img_8.png"}})]),s._v(" "),a("p",[s._v("用另一种启动方式")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" status\n")])])]),a("p",[a("img",{attrs:{src:t(279),alt:"img_9.png"}})]),s._v(" "),a("p",[s._v("启动成功了。")]),s._v(" "),a("h3",{attrs:{id:"插曲"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#插曲"}},[s._v("#")]),s._v(" 插曲")]),s._v(" "),a("p",[s._v("文本编辑工具nano查看docker启动日志/var/log/docker.log")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v(" /var/log/docker.log\n")])])]),a("p",[s._v("看到以下问题")]),s._v(" "),a("p",[a("img",{attrs:{src:t(280),alt:"img_4.png"}})]),s._v(" "),a("p",[s._v("执行命令")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" update-alternatives "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--config")]),s._v(" iptables\n")])])]),a("p",[a("img",{attrs:{src:t(281),alt:"img_5.png"}})]),s._v(" "),a("p",[s._v("设置后还是无效，原来是WSL版本的问题。我使用的还是WSL,并不是WSL2")])])}),[],!1,null,null,null);a.default=r.exports}}]);